#!/usr/bin/env zsh

command -v zsh >/dev/null || sudo apt install zsh

find ~ -maxdepth 1 -name "*.bkp" -delete

local files=('.zlogin' '.zlogout' '.zprofile' '.zshenv' '.zshrc')
for f in $files; do
    [ -e "$HOME/$f" ] && mv "$HOME/$f" "$HOME/$f.$TODAY.$NOW.bkp"
    ln -s "$HOME/workspaces/bernardolm/dotfiles/zsh/startup/$f" "$HOME/$f"
done

log_warn "zsh plugin list: installing $_zsh_plugins_list"

[ ! -d "$ZSH_HOME" ] && mkdir -p -m u=rwx,go=rx "$ZSH_HOME/plugins"

for p in $_zsh_plugins_list; do
    [ ! -d "$ZSH_HOME/plugins/$p" ] && \
        log_info "cloning $p" && \
        git clone --quiet "https://github.com/$p.git" "$ZSH_HOME/plugins/$p"
done
