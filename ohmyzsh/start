log start "ohmyzsh"

start=$(date +%s%N)
# shellcheck source=/dev/null
source "$DOTFILES/ohmyzsh/install"
$SHELL_DEBUG && echo "$(elapsed_time $start) ohmyzsh install"

start=$(date +%s%N)
zstyle ':omz:lib:directories' aliases no
zstyle ':omz:lib:docker-compose' aliases no
zstyle ':omz:lib:docker' aliases no
zstyle ':omz:lib:git' aliases yes
zstyle ':omz:lib:sudo' aliases mo
zstyle ':omz:lib:theme-and-appearance' aliases no
zstyle ':omz:update' mode disabled
$SHELL_DEBUG && echo "$(elapsed_time $start) ohmyzsh zstyle"

start=$(date +%s%N)
plugins=($(ohmyzsh_plugins_list))
log debug "oh-my-zsh plugins loaded: $plugins"
$SHELL_DEBUG && echo "$(elapsed_time $start) ohmyzsh plugins list"

start=$(date +%s%N)
log debug "ohmyzsh calling init script"
# shellcheck source=/dev/null
# ohmyzsh_xtrace_file="$HOME/tmp/oh-my-zsh_$(date +%Y%m%d_%H%M%S_%N).log"
# exec 3>&2 2>$ohmyzsh_xtrace_file
# setopt xtrace prompt_subst
source "${ZSH}/oh-my-zsh.sh"
# unsetopt xtrace
# exec 2>&3 3>&-
# unset ohmyzsh_xtrace_file
echo "$(elapsed_time $start) ohmyzsh init script"

unalias sudo 2>/dev/null

log finish "ohmyzsh"