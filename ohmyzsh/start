log start "ohmyzsh"

# shellcheck source=/dev/null
source "$DOTFILES/ohmyzsh/install"

export ZSH_THEME=""

log start "ohmyzsh: loading plugins list"
list=$(plugins_list $DOTFILES/ohmyzsh/plugins.txt)
plugins+=(${(s: :)list})
log debug "ohmyzsh plugins loaded: $plugins"
log finish "ohmyzsh: loading plugins list"

log start "ohmyzsh: sourcing init script"
source "${ZSH}/oh-my-zsh.sh"
log finish "ohmyzsh: sourcing init script"

unalias sudo 2>/dev/null
unalias rm 2>/dev/null

title "$HOSTNAME"

if [ ! -L "$HOME/.oh-my-zsh/custom/profiles" ]; then
	ln -s "$HOME/sync/zsh_profiles_by_hostname" "$HOME/.oh-my-zsh/custom/profiles"
fi

if [ ! -f "$HOME/sync/zsh_profiles_by_hostname/$HOSTNAME" ]; then
	echo -e "#!/bin/zsh\n# will be loaded when $HOSTNAME shell begins" > "$HOME/sync/zsh_profiles_by_hostname/$HOSTNAME"
fi

log finish "ohmyzsh"
